<!DOCTYPE html>
<html>
<head>
  <title>Masonry Layout example</title>
  <script type="text/javascript" src="../lib/simple-masonry.js"></script>

  <style type="text/css">

    h1, p {
      max-width: 980px;
      margin: auto;
    }

    .container {
      max-width: 980px;
      margin: auto;
      position: relative;
    }

    .block {
      position: absolute;
      top: 0;
      left: 0;
      border: 1px solid blue;
      box-sizing: border-box;

      transition: transform 0.2s;

      overflow: hidden;
    }

    img {
      width: 100%;
      animation: fadeIn 1s forwards;
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
      }

      100% {
        opacity: 1;
      }
    }

  </style>
</head>
<body>

  <h1>Simple example</h1>

  <p>Check the source for details.</p>

  <div class="container">

    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="600" data-height="900" class="block"><img src="http://placehold.it/600x900"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="300" data-height="900" class="block"><img src="http://placehold.it/300x900"/></div>
    <div data-width="500" data-height="1000" class="block"><img src="http://placehold.it/500x1000"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>
    <div data-width="600" data-height="1080" class="block"><img src="http://placehold.it/600x1080"/></div>
    <div data-width="800" data-height="1600" class="block"><img src="http://placehold.it/800x1600"/></div>
    <div data-width="250" data-height="700" class="block"><img src="http://placehold.it/250x700"/></div>
    <div data-width="350" data-height="500" class="block"><img src="http://placehold.it/350x500"/></div>

  </div>

  <script type="text/javascript">

    var $$ = document.querySelectorAll.bind(document)
    var $ = document.querySelector.bind(document)

    var DOMElements = Array.prototype.slice.call($$('.block'))

    // First, let's get some dimensions to feed our LayoutEngine
    var dimensions = DOMElements.map(function (el) {
      return {
        width: parseInt(el.dataset.width),
        height: parseInt(el.dataset.height)
      }
    })

    var container = $('.container')

    // Generate rectangles based on: 
    // - the dimensions we figured out earlier
    // - number of columns we want to display
    // - width of container the columns should be in
    // - and the width of the gutters in between our rectangles (defaults to 0)
    var rectangles = LayoutEngine.generateRectangles({
      dimensions: dimensions, 
      columns: 10, 
      width: container.getBoundingClientRect().width, 
      gutter: 15,
      collapsing: false
    })

    // Transform the rectangle data to the thing we want to display
    // In this case DOM elements
    function toDOMTranslation (rectangle, i) {
      var element = DOMElements[i]
      element.style.transform = 'translate(' + rectangle.x + 'px, ' + rectangle.y + 'px)'
      element.style.width = rectangle.width + 'px'
      element.style.height = rectangle.height + 'px'
    }

    rectangles.map(toDOMTranslation)

    // Do the same trick on resize
    // This part can be optimized, but you get the idea :)
    window.addEventListener('resize', function () {

      var container = $('.container')

      var DOMElements = Array.prototype.slice.call($$('.block'))

      var dimensions = DOMElements.map(function (el) {
        return {
          width: parseInt(el.dataset.width),
          height: parseInt(el.dataset.height)
        }
      })

      // Set number of columns based on mediaquery
      var numColumns = window.matchMedia('(min-width: 800px)').matches ? 5 : 2

      var rectangles = LayoutEngine.generateRectangles({
        dimensions: dimensions, 
        columns: numColumns, 
        width: container.getBoundingClientRect().width, 
        gutter: 15,
        collapsing: true
      })
      rectangles.map(toDOMTranslation)
    })

  </script>

</body>
</html>